apiVersion: infra.contrib.fluxcd.io/v1alpha1
kind: Terraform
metadata:
  name: 07-hello-lamp-from
  namespace: tenant-01  

spec:
  path: ../tf-resources
  interval: 10s
  sourceRef:
    kind: GitRepository
    name: tf-controller-demo
    namespace: flux-system
  storeReadablePlan: human
  approvePlan: "auto"
  writeOutputsToSecret:
    name: 07-output-lamp-from
  alwaysCleanupRunnerPod: false
  ### Pass variables to Terrafrom

  varsFrom:
  - kind: ConfigMap 
    name: lamps
    varsKeys:
    - subject 



# vars:
# - name: subject  
#   valueFrom:
#     configMapKeyRef:
#       name: lamps
#       key: subject


#   kubectl -n tenant-01 get secret tfstate-default-07-hello-lamp-from -ojsonpath='{.data.tfstate}'       | base64 -d | gzip -d 

# vars:
#   description: List of input variables to set for the Terraform program.
#   items:
#     properties:
#       name:
#         description: Name is the name of the variable
#         type: string
#       value:
#         x-kubernetes-preserve-unknown-fields: true
#     required:
#     - name
#     type: object
#   type: array


